<?xml version="1.0" encoding="UTF-8"?>
<mm:content xmlns:mm="http://nokia.com/mmenu" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://nokia.com/mmenu ../mmenuschema.xsd" genre="foldersuite">
    <mm:item count="1" template="empty" id="emptyitem">
        <mm:menuitem name="foldersuite_rsc:R_SKINS_LIST_APPSHELL_LIST" event="custom:change_widget_to_list" position="82" condition="mm:suite/type != list &amp; mm:suite/allowed_types HAS list"/>
        <mm:menuitem name="foldersuite_rsc:R_SKINS_LIST_APPSHELL_GRID" event="custom:change_widget_to_grid" position="82" condition="mm:suite/type != grid &amp; mm:suite/allowed_types HAS grid"/>
        <mm:menuitem name="foldersuite_rsc:R_MENU_FOLDER_EDIT_NON_TOUCH" position="83" condition="params:remove_locked != true" >
            <mm:menuitem name="foldersuite_rsc:R_OPTIONS_ORG_NEW_FOLDER" event="custom:add_folder" position="84" condition="params:remove_locked != true" />
        </mm:menuitem>
        <mm:menuitem name="foldersuite_rsc:R_OPTIONS_HELP" event="custom:help" position="91" />
		
        <mm:msk/>
        
        <mm:event event="custom:add_folder">
            <mm:action service="MultimediaMenu" interface="0x2001CB79">
                <mm:command name="MMCreateNewFolderCommand">
					<mm:key name="item_lock" type="string" value="params:remove_locked" />
                    <mm:key name="folder" type="integer" value="params:folder_id" />
                </mm:command>
            </mm:action>
        </mm:event>
        
        <!-- Change widget type to next list. -->
        <mm:event event="custom:change_widget_to_list">
            <mm:action service="MultimediaMenu">
                <mm:command name="SwitchWidget">
                    <mm:key name="type" type="string" value="list" />
                </mm:command>
            </mm:action>
        </mm:event>

        <mm:event event="custom:change_widget_to_grid">
            <mm:action service="MultimediaMenu">
                <mm:command name="SwitchWidget">
                    <mm:key name="type" type="string" value="grid" />
                </mm:command>
            </mm:action>
        </mm:event>
        
        <mm:event event="custom:help">
            <mm:action service="Service.ActionHandler" interface="IDataAction">
                <mm:command name="Execute">
                        <mm:key name="plugin_id" type="uid" value="0x2001B285" />
                        <mm:key name="data">
                            <mm:key name="help_uid" type="integer" value="270486738" />
                            <mm:key name="help_topic" type="string" value="APP_HLP_APP_SHELL" />
                        </mm:key>
                </mm:command>
            </mm:action>
        </mm:event>
        
    </mm:item>

    <mm:item count="folder_items:ReturnValue/[$count]" template="logical_template_3|list_single_hc_apps_pane" id="folder_suite_items" remove_locked="folder_items:ReturnValue/[$index]/delete_locked" type="folder_items:ReturnValue/[$index]/type" running="folder_items:ReturnValue/[$index]/running" custom_id="folder_items:ReturnValue/[$index]/id" drm_protection="folder_items:ReturnValue/[$index]/drm_protection" uid="folder_items:ReturnValue/[$index]/uid" >

       <mm:menuitem name="foldersuite_rsc:R_MENU_OPEN" event="key:select" position="81" />
       <mm:menuitem name="foldersuite_rsc:R_SKINS_LIST_APPSHELL_LIST" event="custom:change_widget_to_list" position="82" condition="mm:suite/type != list &amp; mm:suite/allowed_types HAS list"/>
       <mm:menuitem name="foldersuite_rsc:R_SKINS_LIST_APPSHELL_GRID" event="custom:change_widget_to_grid" position="82" condition="mm:suite/type != grid &amp; mm:suite/allowed_types HAS grid"/>    
       <mm:menuitem name="foldersuite_rsc:R_MENU_FOLDER_EDIT_NON_TOUCH" position="83" condition="params:remove_locked != true" >
			<mm:menuitem name="foldersuite_rsc:R_OPTIONS_ORG_MOVE" event="custom:edit_mode" position="84" condition="params:remove_locked != true" />
            <mm:menuitem name="foldersuite_rsc:R_OPTIONS_ORG_MOVE_TO_FOLDER" event="custom:move_to_folder" position="85" condition="params:remove_locked != true" />
			<mm:menuitem name="foldersuite_rsc:R_OPTIONS_ORG_NEW_FOLDER" event="custom:add_folder" position="86" condition="params:remove_locked != true" />
            <mm:menuitem name="foldersuite_rsc:R_OPTIONS_SUB_DELETE" event="custom:delete_folder" position="87" condition="folder_items:ReturnValue/[$index]/type = menu:folder &amp; params:remove_locked != true &amp; folder_items:ReturnValue/[$index]/delete_locked != true &amp; folder_items:ReturnValue/[$index]/children_count = 0" />
            <mm:menuitem name="foldersuite_rsc:R_OPTIONS_SUB_DELETE" event="custom:delete_application" position="87" condition="folder_items:ReturnValue/[$index]/type = menu:application &amp; params:remove_locked != true &amp; folder_items:ReturnValue/[$index]/delete_locked != true" />
            <mm:menuitem name="foldersuite_rsc:R_OPTIONS_SUB_RENAME" event="custom:rename_folder" position="88" condition="folder_items:ReturnValue/[$index]/type = menu:folder &amp; params:remove_locked != true &amp; folder_items:ReturnValue/[$index]/delete_locked != true" />
        </mm:menuitem>
        <mm:menuitem name="foldersuite_rsc:R_OPTIONS_HELP" event="custom:help" position="91" />
		
        <mm:query namespace="folder_items" service="Service.MenuContent" interface="IDataSource">
            <mm:constructor>
                <mm:key name="ContentName" type="string" value="matrixmenudata"/>
            </mm:constructor>
            <mm:command mode="async" name="GetList">
                <mm:key name="InData">
                    <mm:key name="id" type="integer" value="params:folder_id"/>
                    <mm:key name="recursive_search" type="boolean" value="FALSE"/>
                    <mm:key name="flat_result" type="boolean" value="TRUE"/>
                </mm:key>
                <mm:key name="Filter">
                    <mm:key name="missing" type="boolean" value="FALSE"/>
                    <mm:key name="hidden" type="boolean" value="FALSE"/>
                    <mm:key name="required_attributes" type="string" value="title_name:long_name:short_name:children_count:bitmap_buffer:mask_buffer:drm_protection:suite_name:widget_type:template:running:uid" />
                </mm:key>
            </mm:command>
        </mm:query>
        
        <mm:notify_request service="Service.MenuContent" interface="IDataSource">
            <mm:constructor>
                <mm:key name="ContentName" type="string" value="matrixmenudata"/>
            </mm:constructor>
            <mm:command mode="async" name="RequestNotification">
                <mm:key name="InData" type="map">
                    <mm:key name="add_remove" type="boolean" value="TRUE" />
                    <mm:key name="reorder" type="boolean" value="TRUE" />
                    <mm:key name="attribute_change" type="boolean" value="TRUE" />
                    <mm:key name="id" type="integer" value="params:folder_id" />
                </mm:key>
            </mm:command>
        </mm:notify_request>
        
        <mm:output alias="mul_title" type="string" value="folder_items:ReturnValue/[$index]/long_name" condition="mm:suite/type = list" />
        <mm:output alias="mul_title" type="string" value="folder_items:ReturnValue/[$index]/short_name" condition="mm:suite/type = grid" />
      
        <mm:output alias="mul_icon">
			<mm:image bitmap="folder_items:ReturnValue/[$index]/bitmap_buffer" mask="folder_items:ReturnValue/[$index]/mask_buffer" />
        </mm:output>
		
        <mm:output alias="mul_indicator_1" condition="folder_items:ReturnValue/[$index]/running = true">
            <mm:image mif_file="gridroot.mif" bitmap_id="EMbmGridrootQgn_indi_app_open" mask_id="EMbmGridrootQgn_indi_app_open_mask" />
        </mm:output>
        
        <mm:output alias="mul_indicator_1" condition="folder_items:ReturnValue/[$index]/drm_protection = expired">
            <mm:image mif_file="gridroot.mif" bitmap_id="EMbmGridrootQgn_prop_drm_rights_exp_super" mask_id="EMbmGridrootQgn_prop_drm_rights_exp_super_mask" />
        </mm:output>
        
        <mm:msk>
            <mm:text value="foldersuite_rsc:R_MENU_OPEN"/>
        </mm:msk>
        
        <mm:event event="key:select">
            
			<mm:action service="MultimediaMenu" condition="folder_items:ReturnValue/[$index]/type = menu:suite">
                <mm:command name="OpenSuite" >
            		<mm:key name="suite_name" type="string" value="folder_items:ReturnValue/[$index]/suite_name" />
                    <mm:key name="params" type="map">
                        <mm:key name="widget_type" type="string" value="folder_items:ReturnValue/[$index]/widget_type"/>
                        <mm:key name="template" type="string" value="folder_items:ReturnValue/[$index]/template"/>                            
                    </mm:key>                    
                </mm:command>
            </mm:action>

			<mm:action service="MultimediaMenu"
                            condition="folder_items:ReturnValue/[$index]/type = menu:folder">
                <mm:command name="OpenSuite">
                    <mm:key name="suite_name" type="string" value="foldersuite" />
                    <mm:key name="params" type="map">
                        <mm:key name="suite_name" type="string" value="folder_items:ReturnValue/[$index]/title_name"/>
                        <mm:key name="folder_id" type="integer" value="folder_items:ReturnValue/[$index]/id"/>
                        <mm:key name="widget_type" type="string" value="folder_items:ReturnValue/[$index]/widget_type"/>
                        <mm:key name="template" type="string" value="folder_items:ReturnValue/[$index]/template"/>
						<mm:key name="remove_locked" type="boolean" value="folder_items:ReturnValue/[$index]/delete_locked"/>
                    </mm:key>
                </mm:command>
            </mm:action>
			
            <mm:action service="Service.MenuContent" interface="IMenuContent" condition="folder_items:ReturnValue/[$index]/type != menu:suite 
                &amp; folder_items:ReturnValue/[$index]/type != menu:folder">
                <mm:constructor>
                    <mm:key name="ContentName" type="string" value="matrixmenudata"/>
                </mm:constructor>
                <mm:command name="ExecuteAction" mode="async">
                        <mm:key name="InData">
                            <mm:key name="id" type="integer" value="folder_items:ReturnValue/[$index]/id"/>
                            <mm:key name="action" type="string8" value="open"/>
                        </mm:key>
                </mm:command>
            </mm:action>
        </mm:event>        

        <mm:event event="key:clear">
            <!-- action for folders -->
            <mm:action service="MultimediaMenu" interface="0x2001CB79" condition="folder_items:ReturnValue/[$index]/type = menu:folder &amp; folder_items:ReturnValue/[$index]/delete_locked != true &amp; folder_items:ReturnValue/[$index]/children_count = 0 &amp; mm:suite/type = grid">
                <mm:command name="MMDeleteFolderCommand">
					<mm:key name="id" type="integer" value="folder_items:ReturnValue/[$index]/id" />
                    <mm:key name="name" type="string" value="folder_items:ReturnValue/[$index]/short_name" />
                    <mm:key name="children_count" type="integer" value="folder_items:ReturnValue/[$index]/children_count" />
                </mm:command>
            </mm:action>
            <mm:action service="MultimediaMenu" interface="0x2001CB79" condition="folder_items:ReturnValue/[$index]/type = menu:folder &amp; folder_items:ReturnValue/[$index]/delete_locked != true &amp; folder_items:ReturnValue/[$index]/children_count = 0 &amp; mm:suite/type = list">
                <mm:command name="MMDeleteFolderCommand">
					<mm:key name="id" type="integer" value="folder_items:ReturnValue/[$index]/id" />
                    <mm:key name="name" type="string" value="folder_items:ReturnValue/[$index]/long_name" />
                    <mm:key name="children_count" type="integer" value="folder_items:ReturnValue/[$index]/children_count" />
                </mm:command>
            </mm:action>
            <!-- action for application, links ...  -->
            <mm:action service="MultimediaMenu" interface="0x2001CB79" condition="folder_items:ReturnValue/[$index]/type = menu:application &amp; folder_items:ReturnValue/[$index]/delete_locked != true">
                <mm:command name="MMDeleteAppCommand">
					<mm:key name="id" type="integer" value="folder_items:ReturnValue/[$index]/id" />
                </mm:command>
            </mm:action>
			<!-- action for suites  -->
            <mm:action service="MultimediaMenu" interface="0x2001CB79" condition="folder_items:ReturnValue/[$index]/type = menu:suite &amp; folder_items:ReturnValue/[$index]/delete_locked != true &amp; mm:suite/type = grid" >
                <mm:command name="MMDeleteSuiteCommand">
                    <mm:key name="name" type="string" value="folder_items:ReturnValue/[$index]/short_name" />
                </mm:command>
            </mm:action>
            <mm:action service="MultimediaMenu" interface="0x2001CB79" condition="folder_items:ReturnValue/[$index]/type = menu:suite &amp; folder_items:ReturnValue/[$index]/delete_locked != true &amp; mm:suite/type = list" >
                <mm:command name="MMDeleteSuiteCommand">
                    <mm:key name="name" type="string" value="folder_items:ReturnValue/[$index]/long_name" />
                </mm:command>
            </mm:action>
        </mm:event>
        
        <mm:event event="custom:help">
            <mm:action service="Service.ActionHandler" interface="IDataAction">
                <mm:command name="Execute">
                        <mm:key name="plugin_id" type="uid" value="0x2001B285" />
                        <mm:key name="data">
                            <mm:key name="help_uid" type="integer" value="270486738" />
                            <mm:key name="help_topic" type="string" value="APP_HLP_APP_SHELL" />
                        </mm:key>
                </mm:command>
            </mm:action>
        </mm:event>
        
        <!-- Change widget type to next list. -->
        <mm:event event="custom:change_widget_to_list">
            <mm:action service="MultimediaMenu">
                <mm:command name="SwitchWidget">
                    <mm:key name="type" type="string" value="list" />
                </mm:command>
            </mm:action>
        </mm:event>
        <!-- Change widget type to next possible grid. -->
        <mm:event event="custom:change_widget_to_grid">
            <mm:action service="MultimediaMenu">
                <mm:command name="SwitchWidget">
                    <mm:key name="type" type="string" value="grid" />
                </mm:command>
            </mm:action>
        </mm:event>
                
		<mm:event event="custom:edit_mode">
            <mm:action service="MultimediaMenu">
                <mm:command name="StartEditMode" />
            </mm:action>
        </mm:event>
        
        <mm:event event="custom:move_mode">
            <mm:action service="MultimediaMenu" interface="0x2001CB79">
                <mm:command name="MMMoveCommand">
                    <mm:key name="folder" type="integer" value="params:folder_id" />
                </mm:command>
            </mm:action>
        </mm:event>
        
        <mm:event event="custom:move_to_folder">
            <mm:action service="MultimediaMenu" interface="0x2001CB79" condition="mm:suite/type = grid" >
                <mm:command name="MMMoveToFolderCommand">
                    <mm:key name="id" type="integer" value="folder_items:ReturnValue/[$index]/id" />
					<mm:key name="name" type="string" value="folder_items:ReturnValue/[$index]/short_name" />
                    <mm:key name="folder" type="integer" value="params:folder_id" />
					<mm:key name="widget" type="string" value="mm:suite/type" />
                </mm:command>
            </mm:action>
            <mm:action service="MultimediaMenu" interface="0x2001CB79" condition="mm:suite/type = list" >
                <mm:command name="MMMoveToFolderCommand">
                    <mm:key name="id" type="integer" value="folder_items:ReturnValue/[$index]/id" />
					<mm:key name="name" type="string" value="folder_items:ReturnValue/[$index]/long_name" />
                    <mm:key name="folder" type="integer" value="params:folder_id" />
					<mm:key name="widget" type="string" value="mm:suite/type" />
                </mm:command>
            </mm:action>
        </mm:event>
        
        <mm:event event="custom:add_folder">
            <mm:action service="MultimediaMenu" interface="0x2001CB79">
                <mm:command name="MMCreateNewFolderCommand">
					<mm:key name="item_lock" type="string" value="params:remove_locked" />
                    <mm:key name="folder" type="integer" value="params:folder_id" />
                </mm:command>
            </mm:action>
        </mm:event>
        
        <mm:event event="custom:delete_folder">
            <mm:action service="MultimediaMenu" interface="0x2001CB79" condition="mm:suite/type = grid" >
                <mm:command name="MMDeleteFolderCommand">
                    <mm:key name="id" type="integer" value="folder_items:ReturnValue/[$index]/id" />
                    <mm:key name="name" type="string" value="folder_items:ReturnValue/[$index]/short_name" />
                    <mm:key name="children_count" type="integer" value="folder_items:ReturnValue/[$index]/children_count" />
                </mm:command>
            </mm:action>
            <mm:action service="MultimediaMenu" interface="0x2001CB79" condition="mm:suite/type = list" >
                <mm:command name="MMDeleteFolderCommand">
                    <mm:key name="id" type="integer" value="folder_items:ReturnValue/[$index]/id" />
                    <mm:key name="name" type="string" value="folder_items:ReturnValue/[$index]/long_name" />
                    <mm:key name="children_count" type="integer" value="folder_items:ReturnValue/[$index]/children_count" />
                </mm:command>
            </mm:action>
        </mm:event>
        
        <mm:event event="custom:delete_application">
            <mm:action service="MultimediaMenu" interface="0x2001CB79" >
                <mm:command name="MMDeleteAppCommand">
					<mm:key name="id" type="integer" value="folder_items:ReturnValue/[$index]/id" />
                </mm:command>
            </mm:action>
        </mm:event>
        
        <mm:event event="custom:rename_folder">
            <mm:action service="MultimediaMenu" interface="0x2001CB79" condition="mm:suite/type = list" >
                <mm:command name="MMRenameFolderCommand">
					<mm:key name="id" type="integer" value="folder_items:ReturnValue/[$index]/id" />
                    <mm:key name="name" type="string" value="folder_items:ReturnValue/[$index]/long_name" />
                </mm:command>
            </mm:action>
            <mm:action service="MultimediaMenu" interface="0x2001CB79" condition="mm:suite/type = grid" >
                <mm:command name="MMRenameFolderCommand">
					<mm:key name="id" type="integer" value="folder_items:ReturnValue/[$index]/id" />
                    <mm:key name="name" type="string" value="folder_items:ReturnValue/[$index]/short_name" />
                </mm:command>
            </mm:action>
        </mm:event>

		<mm:edit_mode count="folder_items:ReturnValue/[$count]" template="logical_template_3|list_single_hc_apps_pane" id="folder_suite_items" remove_locked="folder_items:ReturnValue/[$index]/delete_locked" type="folder_items:ReturnValue/[$index]/type" custom_id="folder_items:ReturnValue/[$index]/id" uid="folder_items:ReturnValue/[$index]/uid">
			
            <mm:menuitem name="Help" event="custom:help" position="91" />
			
			<mm:query namespace="folder_items" service="Service.MenuContent" interface="IDataSource">
				<mm:constructor>
					<mm:key name="ContentName" type="string" value="matrixmenudata"/>
				</mm:constructor>
				<mm:command mode="async" name="GetList">
					<mm:key name="InData">
						<mm:key name="id" type="integer" value="params:folder_id"/>
						<mm:key name="recursive_search" type="boolean" value="FALSE"/>
						<mm:key name="flat_result" type="boolean" value="TRUE"/>
					</mm:key>
					<mm:key name="Filter">
						<mm:key name="missing" type="boolean" value="FALSE"/>
                        <mm:key name="hidden" type="boolean" value="FALSE"/>
                        <mm:key name="required_attributes" type="string" value="title_name:long_name:short_name:children_count:bitmap_buffer:mask_buffer:drm_protection:suite_name:widget_type:template:running:uid" />
					</mm:key>
				</mm:command>
			</mm:query>
            
			<mm:notify_request service="Service.MenuContent" interface="IDataSource">
				<mm:constructor>
					<mm:key name="ContentName" type="string" value="matrixmenudata"/>
				</mm:constructor>
				<mm:command mode="async" name="RequestNotification">
					<mm:key name="InData" type="map">
						<mm:key name="add_remove" type="boolean" value="TRUE" />
                        <mm:key name="reorder" type="boolean" value="TRUE" />
                        <mm:key name="attribute_change" type="boolean" value="TRUE" />
						<mm:key name="id" type="integer" value="params:folder_id" />
					</mm:key>
				</mm:command>
			</mm:notify_request>
			
            <mm:output alias="mul_title" type="string" value="folder_items:ReturnValue/[$index]/long_name" condition="mm:suite/type = list" />
            <mm:output alias="mul_title" type="string" value="folder_items:ReturnValue/[$index]/short_name" condition="mm:suite/type = grid" />

			
      
	        <mm:output alias="mul_icon">
				<mm:image bitmap="folder_items:ReturnValue/[$index]/bitmap_buffer"  mask="folder_items:ReturnValue/[$index]/mask_buffer" />
	        </mm:output>

		
		    <mm:output alias="mul_move_indicator_arrow_top" >
	            <mm:image mif_file="move_indicator_icons.mif" 
	                      bitmap_id="EMbmMove_indicator_iconsQgn_indi_org_arrow_up"
	                      mask_id="EMbmMove_indicator_iconsQgn_indi_org_arrow_up_mask" />            
	        </mm:output>
	        
	        <mm:output alias="mul_move_indicator_arrow_bottom" >
	            <mm:image mif_file="move_indicator_icons.mif" 
	                      bitmap_id="EMbmMove_indicator_iconsQgn_indi_org_arrow_down"
	                      mask_id="EMbmMove_indicator_iconsQgn_indi_org_arrow_down_mask" />            
	        </mm:output>
	        
	        <mm:output alias="mul_move_indicator_arrow_left" >
	            <mm:image mif_file="move_indicator_icons.mif" 
	                      bitmap_id="EMbmMove_indicator_iconsQgn_indi_org_arrow_left"
	                      mask_id="EMbmMove_indicator_iconsQgn_indi_org_arrow_left_mask" />            
	        </mm:output>
	        
	        <mm:output alias="mul_move_indicator_arrow_right" >
	            <mm:image mif_file="move_indicator_icons.mif" 
	                      bitmap_id="EMbmMove_indicator_iconsQgn_indi_org_arrow_right"
	                      mask_id="EMbmMove_indicator_iconsQgn_indi_org_arrow_right_mask" />            
	        </mm:output>

            <mm:event event="key:select">
                <mm:action service="MultimediaMenu">
                    <mm:command name="StopEditMode" />
                </mm:action>
            </mm:event>            
            
            <mm:event event="key:move">
                <mm:action service="Service.MenuContent" interface="IMenuContent">
                    <mm:constructor>
                        <mm:key name="ContentName" type="string" value="matrixmenudata" />
                    </mm:constructor>
                    <mm:command name="Organize" mode="async">
                        <mm:key name="InData">
                            <mm:key name="item_ids" type="list">
                                <mm:key name="id" type="boolean" value="event_data:dragged_custom_id" />
                                </mm:key>
                            <mm:key name="before_item_id" type="boolean" value="event_data:dropped_before_custom_id" />
                        </mm:key>
                    </mm:command>
                </mm:action>
            </mm:event>
           
            <mm:event event="custom:help">
                <mm:action service="Service.ActionHandler" interface="IDataAction">
                    <mm:command name="Execute">
                            <mm:key name="plugin_id" type="uid" value="0x2001B285" />
                            <mm:key name="data">
                                <mm:key name="help_uid" type="integer" value="270486738" />
                                <mm:key name="help_topic" type="string" value="APP_HLP_APP_SHELL" />
                            </mm:key>
                    </mm:command>
                </mm:action>
            </mm:event>
		   
		</mm:edit_mode>
    </mm:item>
</mm:content>
